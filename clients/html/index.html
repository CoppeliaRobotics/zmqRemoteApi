<html>
    <head>
        <script src="https://cdn.socket.io/4.1.2/socket.io.min.js" integrity="sha384-toS6mmwu70G0fw54EGlWWeA4z3dyJ+dlXBtSURSKN4vyRFOcxd3Bzjj/AoOwY+Rg" crossorigin="anonymous"></script>
        <script type="text/javascript">
            class RemoteAPIClient {
                constructor() {
                    this.socket = io('ws://127.0.0.1:8080');
                    this.socket.on('error', console.error.bind(console));
                    this.socket.on('message', console.log.bind(console));
                }
                call(fn,args,callback,errcb) {
                    var req = {func: fn, args: args};
                    console.log('Req:', req);
                    this.socket.send(req, function(rep) {
                        console.log('Rep:', rep);
                        if(rep.success) {if(callback) callback(rep.ret);}
                        else if(errcb) errcb(rep.error);
                    });
                }
            }
            var client = new RemoteAPIClient();
        </script>
    </head>
    <body>
        <script type="text/javascript">
            function exec() {
                var v = document.getElementById('in').value;
                client.call('sim.getObjectHandle',[v],
                    function(ret){document.getElementById('out').value = ret;},
                    function(err){alert(err);}
                );
            }
        </script>
        sim.getObjectHandle(<input type="text" size="20" id="in" />)
        <input type="button" value="-&gt;" onclick="exec();" />
        <input type="text" size="20" id="out" />
    </body>
</html>
